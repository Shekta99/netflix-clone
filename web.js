const movies = [
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/t1.PNG?raw=true",
    alt: "scary movie",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p3.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p4.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p5.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p6.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p7.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Popular on Netflix",
  },

  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Trending Now",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Trending Now",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Trending Now",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Trending Now",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Trending Now",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Trending Now",
  },

  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "TV Shows",
  },

  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Blockbuster Action & Adventure",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Blockbuster Action & Adventure",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Blockbuster Action & Adventure",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Blockbuster Action & Adventure",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Blockbuster Action & Adventure",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Blockbuster Action & Adventure",
  },

  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Netflix Originals",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Netflix Originals",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Netflix Originals",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Netflix Originals",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Netflix Originals",
  },
  {
    src: "https://github.com/carlosavilae/Netflix-Clone/blob/master/img/p2.PNG?raw=true",
    alt: "",
    link: "https://www.youtube.com/embed/VVWH9jJLGkE",
    section: "Netflix Originals",
  },
];

const socket = io();

socket.on("down", () => {
  scrollBy(0, 100);
});

socket.on("up", () => {
  scrollBy(0, -100);
});

socket.on("home", () => {
  mainPage();
});

socket.on("tvshow", () => {
  window.location.assign("/index.html#tvShows");
});

socket.on("movies", () => {
  window.location.assign("/index.html#movies");
});

socket.on("originals", () => {
  window.location.assign("/index.html#originals");
});

socket.on("play", () => {
  document.getElementById("player").click();
  if (playVideo) {
    playVideo();
  }
});

socket.on("pause", () => {
  if (pauseVideo) {
    pauseVideo();
  }
});

socket.on("subir_volume", () => {
  if (subirVolume) {
    subirVolume();
  }
});

socket.on("bajar_volume", () => {
  if (bajarVolume) {
    bajarVolume();
  }
});

socket.on("mutear_volume", () => {
  if (mutearVolume) {
    mutearVolume();
  }
});

socket.on("adelantar_video", () => {
  if (adelantarVideo) {
    adelantarVideo();
  }
});

socket.on("retrasar_video", () => {
  if (retrasarVideo) {
    retrasarVideo();
  }
});

let playVideo = null;
let pauseVideo = null;
let player = null;
let subirVolume = null;
let bajarVolume = null;
let mutearVolume = null;
let adelantarVideo = null;
let retrasarVideo = null;

const searchButton = document.getElementById("search-button");

const mainPage = () => {
  scroll(0, 0);
  const mainContainer = document.querySelector(".main-container");
  mainContainer.innerHTML = "";
  createSection("Popular on Netflix", null);
  createSection("Trending Now", null);
  createSection("TV Shows", null);
  createSection("Blockbuster Action & Adventure", null);
  createSection("Netflix Originals", null);
};

const logo = document.getElementById("logo");
logo.onclick = mainPage;

const home = document.getElementById("home");
home.onclick = mainPage;

const chargeMovie = () => {
  const mainContainer = document.querySelector(".main-container");
  mainContainer.innerHTML = "";
};

const createMovie = (src, alt, link) => {
  const a = document.createElement("a");
  const image = document.createElement("img");
  image.setAttribute("src", src);
  image.setAttribute("alt", alt);
  a.setAttribute("href", `/index.html?video=${link}`);
  a.appendChild(image);
  return a;
};

const createSection = (title, value) => {
  const mainContainer = document.querySelector(".main-container");
  if (title == "Results") {
    mainContainer.innerHTML = "";
  }
  const h1 = document.createElement("h1");

  if (title == "TV Shows") {
    h1.setAttribute("id", "tvShows");
  } else if (title == "Blockbuster Action & Adventure") {
    h1.setAttribute("id", "movies");
  } else if (title == "Netflix Originals") {
    h1.setAttribute("id", "originals");
  } else {
    h1.setAttribute("id", "myList");
  }

  h1.innerText = title;
  const div = document.createElement("div");
  div.setAttribute("class", "box");
  mainContainer.appendChild(h1);
  if (title == "Results") {
    const filter = movies.filter((movie) =>
      movie.alt.search(value) === -1 ? false : true
    );
    filter.forEach((movie) => {
      const a = createMovie(movie.src, movie.alt, movie.link);
      div.appendChild(a);
    });
  }
  if (title == "Popular on Netflix") {
    const filter = movies.filter(
      (movie) => movie.section === "Popular on Netflix"
    );
    filter.forEach((movie) => {
      const a = createMovie(movie.src, movie.alt, movie.link);
      div.appendChild(a);
    });
  }

  if (title == "Trending Now") {
    const filter = movies.filter((movie) => movie.section === "Trending Now");
    filter.forEach((movie) => {
      const a = createMovie(movie.src, movie.alt, movie.link);
      div.appendChild(a);
    });
  }

  if (title == "TV Shows") {
    const filter = movies.filter((movie) => movie.section === "TV Shows");
    filter.forEach((movie) => {
      const a = createMovie(movie.src, movie.alt, movie.link);
      div.appendChild(a);
    });
  }

  if (title == "Blockbuster Action & Adventure") {
    const filter = movies.filter(
      (movie) => movie.section === "Blockbuster Action & Adventure"
    );
    filter.forEach((movie) => {
      const a = createMovie(movie.src, movie.alt, movie.link);
      div.appendChild(a);
    });
  }

  if (title == "Netflix Originals") {
    const filter = movies.filter(
      (movie) => movie.section === "Netflix Originals"
    );
    filter.forEach((movie) => {
      const a = createMovie(movie.src, movie.alt, movie.link);
      div.appendChild(a);
    });
  }
  mainContainer.appendChild(div);
};

const search = () => {
  const searchBar = document.getElementById("search-bar");
  const value = searchBar.value;
  if (value) {
    createSection("Results", value);
  }
};

searchButton.onclick = search;

let params = new URLSearchParams(document.location.search);
let video = params.get("video");
console.log(video);
if (video) {
  chargeMovie(video);
  function onYouTubeIframeAPIReady() {
    player = new YT.Player("player", {
      height: "390",
      width: "640",
      videoId: "M7lc1UVf-VE",
      playerVars: {
        autoplay: 1,
        enablejsapi: 1,
        playsinline: 1,
      },
      events: {
        onReady: onPlayerReady,
      },
    });
    function onPlayerReady(event) {
      event.target.playVideo();
    }

    pauseVideo = () => {
      player.pauseVideo();
    };
    playVideo = () => {
      player.playVideo();
    };

    subirVolume = () => {
      player.unMute();
      volumen_actual = player.getVolume();
      volumen_nuevo = volumen_actual + 10;
      player.setVolume(volumen_nuevo);
    };

    bajarVolume = () => {
      volumen_actual = player.getVolume();
      volumen_nuevo = volumen_actual - 10;
      player.setVolume(volumen_nuevo);
    };
    mutearVolume = () => {
      player.mute();
    };
    adelantarVideo = () => {
      tiempo_actual = player.getCurrentTime();
      tiempo_nuevo = tiempo_actual + 15;
      player.seekTo(tiempo_nuevo);
    };
    retrasarVideo = () => {
      tiempo_actual = player.getCurrentTime();
      tiempo_nuevo = tiempo_actual - 15;
      player.seekTo(tiempo_nuevo);
    };
  }
} else {
  mainPage();
}
